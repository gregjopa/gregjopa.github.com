{"componentChunkName":"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx","path":"/2013/11/render-svg-charts-server-side-with-d3-js","result":{"data":{"post":{"__typename":"MdxPost","slug":"/2013/11/render-svg-charts-server-side-with-d3-js","title":"Render SVG Charts Server-side with D3.js","date":"11.25.2013","tags":[{"name":"JavaScript","slug":"java-script"},{"name":"Node.js","slug":"node-js"}],"description":null,"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Render SVG Charts Server-side with D3.js\",\n  \"slug\": \"2013/11/render-svg-charts-server-side-with-d3-js\",\n  \"date\": \"2013-11-25T20:25:19.000Z\",\n  \"comments\": true,\n  \"tags\": [\"JavaScript\", \"Node.js\"]\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(Alert, {\n    mdxType: \"Alert\"\n  }, mdx(\"strong\", null, \"Update: \"), \"This blog post is really old. Here's a more recent post about this topic: \", mdx(\"br\", null), mdx(\"a\", {\n    href: \"/2020/05/render-d3-charts-server-side\",\n    style: {\n      \"marginTop\": \"1rem\",\n      \"display\": \"inline-block\"\n    }\n  }, \"Render D3.js charts server-side with Node version 12+\")), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"546px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"64.16666666666666%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAQCAwX/xAAVAQEBAAAAAAAAAAAAAAAAAAABAv/aAAwDAQACEAMQAAAB06GIXC4yJ//EABsQAAEEAwAAAAAAAAAAAAAAAAIAAQMTERIx/9oACAEBAAEFAjldiI8n1FHsVKqX/8QAFhEBAQEAAAAAAAAAAAAAAAAAABEB/9oACAEDAQE/AdqP/8QAFhEAAwAAAAAAAAAAAAAAAAAAAAER/9oACAECAQE/AVCo/8QAGRAAAgMBAAAAAAAAAAAAAAAAABEBITFB/9oACAEBAAY/AlHBwWNmmn//xAAcEAADAAIDAQAAAAAAAAAAAAAAAREhYTFB4fD/2gAIAQEAAT8hkzbY7iukV5NWXMN0fMFPk//aAAwDAQACAAMAAAAQgx//xAAWEQEBAQAAAAAAAAAAAAAAAAAAARH/2gAIAQMBAT8Qimn/xAAVEQEBAAAAAAAAAAAAAAAAAAABEP/aAAgBAgEBPxBAl//EACAQAAICAQMFAAAAAAAAAAAAAAERACFRMUHwYaGx0fH/2gAIAQEAAT8QAqhNujTvDwxUMFFX7jpIyGY3FW2WZx+4hy8z/9k=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"img\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"D3 Bar Chart\",\n    \"title\": \"D3 Bar Chart\",\n    \"src\": \"/static/e35c63039de0249c8c8169f2c38e61fb/88627/d3_server_side_screenshot.jpg\",\n    \"srcSet\": [\"/static/e35c63039de0249c8c8169f2c38e61fb/46946/d3_server_side_screenshot.jpg 240w\", \"/static/e35c63039de0249c8c8169f2c38e61fb/55489/d3_server_side_screenshot.jpg 480w\", \"/static/e35c63039de0249c8c8169f2c38e61fb/88627/d3_server_side_screenshot.jpg 546w\"],\n    \"sizes\": \"(max-width: 546px) 100vw, 546px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  })), \"\\n    \")), mdx(\"p\", null, \"It's common to use d3.js to render svg charts on the client-side. With the d3 node module you can render svg charts on the server-side as well. The d3 node module uses jsdom to simulate the browser's Document Object Model (DOM) which allows for d3 selectors to work on the server-side.\"), mdx(\"p\", null, \"Running D3 on the server with Node.js is pretty easy. You can reuse most of your client-side d3 code on the server. The only tricky part is integrating d3 widgets into your server-side views.\"), mdx(DemoButtonGroup, {\n    downloadLink: \"https://github.com/gregjopa/d3-server-side-demo\",\n    mdxType: \"DemoButtonGroup\"\n  }), mdx(\"h2\", null, \"Getting started with running D3 on Node.js\"), mdx(\"p\", null, \"Install the d3 node module using npm: \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"npm install d3\"), \". The d3 node module uses jsdom which requires a C++ compiler. Read more about this dependency here: \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/tmpvar/jsdom#contextify\"\n  }), \"https://github.com/tmpvar/jsdom#contextify\")), mdx(\"p\", null, \"After you get d3 installed you can require it like any other node module:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-javascript\"\n  }), \"var d3 = require('d3');\\n\")), mdx(\"h2\", null, \"Reusable Chart Pattern\"), mdx(\"p\", null, \"I recommend using the reusable chart design pattern for your charts: \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"http://bost.ocks.org/mike/chart/\"\n  }), \"http://bost.ocks.org/mike/chart/\"), \". This modular pattern works great on the client and on the server. Since the reusable chart pattern is just a function you can assign it directly to module.exports:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-javascript\"\n  }), \"var barChart = module.exports = function() { ...\\n\")), mdx(\"h2\", null, \"D3 View Helper\"), mdx(\"p\", null, \"My demo app uses the \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"http://expressjs.com/\"\n  }), \"express.js\"), \" web framework with the ejs templating engine. I want to be able to integrate my D3 chart widgets into my view templates. I accomplished this by appending my chart widget to the jsdom and then getting it's outerHTML value and rendering it in my ejs template:\"), mdx(\"h4\", null, \"bar_chart_helper.js\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-javascript\"\n  }), \"var getBarChart = function (params) {\\n\\n  var chart = barChart()\\n    .data(params.data)\\n    .width(params.width)\\n    .height(params.height)\\n    .xAxisLabel(params.xAxisLabel)\\n    .yAxisLabel(params.yAxisLabel);\\n\\n\\n  // append to jsdom\\n  d3.select('body').append('div').attr('id', params.containerId).call(chart);\\n\\n  var selector = '#' + params.containerId;\\n\\n  // get html string \\\"<div id=\\\"bar-chart-small\\\"><svg class=\\\"svg-chart\\\"> ...\\\"\\n  var svg = d3.select(selector).node().outerHTML;\\n\\n  // remove from jsdom\\n  d3.select(selector).remove();\\n\\n  return svg;\\n\\n};\\n\")), mdx(\"h4\", null, \"index.html\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-html\"\n  }), \"<!-- ejs template -->\\n<h1>D3 Server-side Demo</h1>\\n<%-\\n  barChartHelper.getBarChart({\\n    data: fixtureData,\\n    width: 400,\\n    height: 300,\\n    xAxisLabel: '2012',\\n    yAxisLabel: 'Views',\\n    containerId: 'bar-chart-small'\\n  })\\n%>\\n\")), mdx(\"p\", null, \"To see this code in action download my d3-server-side-demo express.js app here: \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/gregjopa/d3-server-side-demo\"\n  }), \"https://github.com/gregjopa/d3-server-side-demo\")));\n}\n;\nMDXContent.isMDXComponent = true;","excerpt":"It's common to use d3.js to render svg charts on the client-side. With the d3 node module you can render svg charts on the server-side asâ€¦","timeToRead":1,"banner":null}},"pageContext":{"slug":"/2013/11/render-svg-charts-server-side-with-d3-js","formatString":"MM.DD.YYYY"}}}